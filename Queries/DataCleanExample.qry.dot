digraph tree {
rankdir="LR"
node [shape=record];
node [style=rounded];
"top" [label="OP: plan | {ID: top}"];
"data" [label="OP: filescan | {ID: data}"];
"detectors" [label="OP: unnest | {ID: detectors}"];
"ts" [label="OP: unnest | {ID: ts}"];
"starttime" [label="OP: unnest | {ID: starttime}"];
"detector" [label="OP: unnest | {ID: detector}"];
"detectorid" [label="OP: unnest | {ID: detectorid}"];
"segmentid" [label="OP: unnest | {ID: segmentid}"];
"volume" [label="OP: unnest | {ID: volume}"];
"speed" [label="OP: unnest | {ID: speed}"];
"occupancy" [label="OP: unnest | {ID: occupancy}"];
"dup1" [label="OP: dup | {ID: dup1}"];
"occupancy_or_speed" [label="OP: select | {ID: occupancy_or_speed}"];
"speed_and_volume_ok_1" [label="OP: select | {ID: speed_and_volume_ok_1}"];
"speed_and_volume_ok_2" [label="OP: select | {ID: speed_and_volume_ok_2}"];
"good" [label="OP: select | {ID: good}"];
"good_to_union" [label="OP: construct | {ID: good_to_union}"];
"shifted" [label="OP: expression | {ID: shifted}"];
"good_shifted" [label="OP: construct | {ID: good_shifted}"];
"occupancy_or_speed_gt" [label="OP: select | {ID: occupancy_or_speed_gt}"];
"speed_0_and_volume_not_0" [label="OP: select | {ID: speed_0_and_volume_not_0}"];
"volume_0_and_speed_not_0" [label="OP: select | {ID: volume_0_and_speed_not_0}"];
"volume_0_and_occupancy_not_0" [label="OP: select | {ID: volume_0_and_occupancy_not_0}"];
"bad" [label="OP: union | {ID: bad}"];
"project_bad" [label="OP: construct | {ID: project_bad}"];
"bad_to_join" [label="OP: rename | {ID: bad_to_join}"];
"replacement" [label="OP: join | {ID: replacement}"];
"replacement_to_union" [label="OP: construct | {ID: replacement_to_union}"];
"cleaned" [label="OP: union | {ID: cleaned}"];
"cleaned" -> "top";
"data" -> "detectors";
"detectors" -> "ts";
"ts" -> "starttime";
"starttime" -> "detector";
"detector" -> "detectorid";
"detectorid" -> "segmentid";
"segmentid" -> "volume";
"volume" -> "speed";
"speed" -> "occupancy";
"occupancy" -> "dup1";
"dup1" -> "occupancy_or_speed";
"occupancy_or_speed" -> "speed_and_volume_ok_1";
"speed_and_volume_ok_1" -> "speed_and_volume_ok_2";
"speed_and_volume_ok_2" -> "good";
"good" -> "good_to_union";
"good" -> "shifted";
"shifted" -> "good_shifted";
"dup1" -> "occupancy_or_speed_gt";
"dup1" -> "speed_0_and_volume_not_0";
"dup1" -> "volume_0_and_speed_not_0";
"dup1" -> "volume_0_and_occupancy_not_0";
"occupancy_or_speed_gt" -> "bad";
"speed_0_and_volume_not_0" -> "bad";
"volume_0_and_speed_not_0" -> "bad";
"volume_0_and_occupancy_not_0" -> "bad";
"bad" -> "project_bad";
"project_bad" -> "bad_to_join";
"good_shifted" -> "replacement";
"bad_to_join" -> "replacement";
"replacement" -> "replacement_to_union";
"replacement_to_union" -> "cleaned";
"good_to_union" -> "cleaned";
}
